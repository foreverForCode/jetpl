/*

 @Name：jetpl v1.2 JS模板引擎
 @Author：陈国军
 @Date：2016-7-2
 @QQ群：516754269
 @官网：http://www.jayui.com/jetpl/  或　 https://github.com/singod/jetpl　
        
*/
(function(d,f){"function"===typeof define&&define.amd?define(["jetpl"],f):"object"===typeof exports?module.exports=f(require("jetpl")):d.jetpl=f(d.jetpl)})(this,function(d){var f={},l={error:function(a,c){"object"===typeof console&&console.error("jetpl "+a+"\n"+(c||""));return"jetpl "+a}},g=function(a){a=a||"";/^\#/.test(a)&&(a=document.getElementById(a.substring(1)).innerHTML);this.tpl=a;this.tplinit();f[a]=this};g.prototype.tplCompiler=function(a){var c=0;return'var outStr\x3d"";\n'+a.replace(/(^|%>|}})([\s\S]*?)({{|<%|$)/g,function(a,c,h,k){return c+'outStr+\x3d "'+h.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r?\n/g,"\\n")+'";\n'+k}).replace(/(<%=)([\s\S]*?)(%>)/g,"outStr+\x3d ($2);\n").replace(/(<%)(?!=)([\s\S]*?)(%>)/g,"\n$2\n").replace(/{{each\s*([\w."'\][]+)\s*(\w+)\s*(\w+)?}}/g,function(a,e,h,k){a="tps"+c++;return("for(var $p\x3d0; $p\x3c$1.length; $p++){"+(h?"\nvar $2 \x3d $1[$p];\n":"\nvar $item \x3d $1[$p];\n")+(k?"\nvar $3 \x3d $p;\n":"")).replace(/\$1/g,e).replace(/\$2/g,h).replace(/\$3/g,k).replace(/\$p/g,a)}).replace(/{{\/each}}/g,"};\n").replace(/{{if\s+(.*?)}}/g,"if($1){").replace(/{{else ?if (.*?)}}/g,"}else if($1){").replace(/{{else}}/g,"}else{").replace(/{{\/if}}/g,"}").replace(/{{=?([\s\S]*?)}}/g,"outStr+\x3d$1;\n")+"return outStr;"};g.prototype.dataToVars=function(a){a=Object.keys(a||{}).sort();for(var c="";a.length;)var b=a.shift(),c=c+("var "+b+'\x3d dt["'+b+'"];');return c};g.prototype.tplinit=function(){var a=this,c=a.tpl,b=function(b,c){f[b]=f[b]||{};var e=a.dataToVars(c);if(f[b].vars==e)return f[b].refuns;var d=f[b].code||a.tplCompiler(b),g=new Function("dt",e+d);f[b].vars=e;f[b].code=d;return f[b].refuns=g},e=function(a,c){var e=b(a,c);return 1<arguments.length?e(c):function(c){return b(a,c)(c)}};return a.render=function(a,b){if(!a)return l.error("no data");try{var d=e(c,a);if(!b)return e(c)(a);b(d)}catch(f){return b("jetpl "+f),l.error(f,c)}}};d=function(a){return"string"!==typeof a?l.error("Template not found"):new g(a)};d.decimal=function(a,c){c=c?c:2;var b=(Math.round(a*Math.pow(10,c))/Math.pow(10,c)).toString(),e=b.indexOf(".");0>e&&(e=b.length,b+=".");for(;b.length<=e+c;)b+="0";return b};d.decode=function(a){return a.replace(/&amp;/g,"\x26").replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e").replace(/&quot;/g,'"').replace(/&#39;/g,"'")};d.escape=function(a){return String(a||"").replace(/&(?!#?[a-zA-Z0-9]+;)/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/'/g,"\x26#39;").replace(/"/g,"\x26quot;")};d.toNumber=function(a){return a.toString()};d.date=function(a,c){var b=c||"YYYY-MM-DD",e=new Date(1E3*a),d={"M+":e.getMonth()+1,"D+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),ms:e.getMilliseconds()};/(Y+)/.test(b)&&(b=b.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var f in d)(new RegExp("("+f+")")).test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?d[f]:("00"+d[f]).substr((""+d[f]).length)));return b};d.include=function(a,c){var b=document.getElementById(a.replace(/\#/g,"")),b=/input|textarea/i.test(b.nodeName)?b.value:b.innerHTML;return d(b).render(c)};d.version="1.2";return d});
